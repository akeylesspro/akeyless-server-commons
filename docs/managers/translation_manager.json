{
  "metadata": {
    "source_file": "src/managers/translation_manager.ts",
    "path": "docs/managers/translation_manager.md",
    "type": "module"
  },
  "purpose": "Singleton translation manager providing cached translation lookups for UI messages, SMS messages, and email content. Supports multiple languages and scopes with fallback to key names when translations are missing.",
  "dependencies": [
    "EntityOptions from src/types - Entity type enumeration",
    "LangOptions from src/types - Language enumeration",
    "TObject from akeyless-types-commons - Generic object type"
  ],
  "architecture": {
    "pattern": "Singleton Pattern",
    "description": "The TranslationManager uses singleton pattern to ensure a single shared translation cache across the application.",
    "details": [
      "Data Structure: Translations are stored in a nested object structure: { [scope: string]: { [lang: string]: { [key: string]: string; } } }",
      "Key Format: Translation keys use double underscore (__) separator: Format: {entity}__{key}, Example: \"user_verification__code\", If entity is empty, key is used as-is: \"key\" (no separator)"
    ]
  },
  "sections": [
    {
      "title": "Exports and behavior",
      "exports": [
        {
          "name": "TranslationManager",
          "type": "class",
          "description": "Singleton class for translation management.",
          "methods": [
            {
              "name": "getInstance",
              "signature": "getInstance(): TranslationManager",
              "type": "method",
              "description": "Returns the singleton instance.",
              "returns": "TranslationManager instance"
            },
            {
              "name": "setTranslationData",
              "signature": "setTranslationData(data: TObject<any>): void",
              "type": "method",
              "description": "Sets the translation data cache.",
              "parameters": [
                {
                  "name": "data",
                  "type": "TObject<any>",
                  "description": "Translation data object (replaces entire cache)"
                }
              ],
              "behavior": [
                "Replaces all existing translation data",
                "Typically called during snapshot initialization",
                "Used by Firebase snapshot parsers"
              ],
              "examples": [
                {
                  "code": "translation_manager.setTranslationData({\n  push_notifications: {\n    he: { \"title__event\": \"כותרת\" },\n    en: { \"title__event\": \"Title\" }\n  }\n});",
                  "language": "typescript"
                }
              ]
            },
            {
              "name": "getTranslationData",
              "signature": "getTranslationData(): TObject<any>",
              "type": "method",
              "description": "Retrieves the entire translation data cache.",
              "returns": "Current translation data object"
            },
            {
              "name": "get_translation",
              "signature": "get_translation(scope: string, lang: string, entity: string, key: string): string",
              "type": "method",
              "description": "Retrieves a translation from the cache.",
              "parameters": [
                {
                  "name": "scope",
                  "type": "string",
                  "description": "Translation scope (e.g., \"push_notifications\", \"ui\")"
                },
                {
                  "name": "lang",
                  "type": "string",
                  "description": "Language code (e.g., \"he\", \"en\", \"ru\")"
                },
                {
                  "name": "entity",
                  "type": "string",
                  "description": "Entity identifier (e.g., \"event_from_device\", \"user_verification\")"
                },
                {
                  "name": "key",
                  "type": "string",
                  "description": "Translation key (e.g., \"title\", \"body\")"
                }
              ],
              "returns": "Translation string or key if not found",
              "behavior": [
                "Constructs lookup key: {entity}{entity ? \"__\" : \"\"}{key}",
                "Looks up: data[scope][lang][lookupKey]",
                "Returns translation if found",
                "Returns lookup key as fallback if not found"
              ],
              "examples": [
                {
                  "code": "const title = translation_manager.get_translation(\n  'push_notifications',\n  'he',\n  'event_from_device',\n  'title'\n);\n// Looks up: data['push_notifications']['he']['event_from_device__title']\n// Returns: \"אירוע מהמכשיר\" or \"event_from_device__title\" if not found",
                  "language": "typescript"
                }
              ]
            },
            {
              "name": "get_sms",
              "signature": "get_sms(lang: LangOptions, entity: EntityOptions, key: string): string",
              "type": "method",
              "description": "Retrieves an SMS translation.",
              "parameters": [
                {
                  "name": "lang",
                  "type": "LangOptions",
                  "description": "Language option (LangOptions enum)"
                },
                {
                  "name": "entity",
                  "type": "EntityOptions",
                  "description": "Entity option (EntityOptions enum)"
                },
                {
                  "name": "key",
                  "type": "string",
                  "description": "Translation key"
                }
              ],
              "returns": "Translation string or \"N/A\" if not found",
              "behavior": [
                "Constructs lookup key: \"{entity}__{key}\"",
                "Looks up: data[\"sms\"][lang][lookupKey]",
                "Returns translation if found",
                "Returns \"N/A\" if lookup fails (try-catch)"
              ],
              "error_handling": [
                "Wrapped in try-catch",
                "Returns \"N/A\" on any error (missing scope, lang, or key)"
              ],
              "examples": [
                {
                  "code": "const smsCode = translation_manager.get_sms(\n  LangOptions.he,\n  EntityOptions.user_verification,\n  'code'\n);\n// Looks up: data['sms']['he']['user_verification__code']\n// Returns: \"קוד האימות שלך הוא: {code}\" or \"N/A\"",
                  "language": "typescript"
                }
              ]
            },
            {
              "name": "get_email",
              "signature": "get_email(lang: LangOptions, entity: EntityOptions, key: string): string",
              "type": "method",
              "description": "Retrieves an email translation.",
              "parameters": [
                {
                  "name": "lang",
                  "type": "LangOptions",
                  "description": "Language option"
                },
                {
                  "name": "entity",
                  "type": "EntityOptions",
                  "description": "Entity option"
                },
                {
                  "name": "key",
                  "type": "string",
                  "description": "Translation key"
                }
              ],
              "returns": "Translation string or \"N/A\" if not found",
              "behavior": [
                "Same as get_sms but looks up in data[\"email\"] scope"
              ],
              "examples": [
                {
                  "code": "const emailSubject = translation_manager.get_email(\n  LangOptions.en,\n  EntityOptions.welcome,\n  'subject'\n);\n// Looks up: data['email']['en']['welcome__subject']\n// Returns: \"Welcome to our service!\" or \"N/A\"",
                  "language": "typescript"
                }
              ]
            }
          ]
        },
        {
          "name": "translation_manager",
          "type": "variable",
          "description": "Exported singleton instance for direct use."
        }
      ]
    }
  ],
  "context": [
    "The translation manager provides:",
    "Multi-language Support - Supports multiple languages",
    "Scoped Translations - Organizes translations by scope",
    "Fallback Handling - Returns key if translation missing",
    "Cached Access - Fast in-memory lookups",
    "Type Safety - Uses enums for language and entity types"
  ],
  "best_practices": [
    "Use consistent entity and key naming",
    "Provide translations for all supported languages",
    "Use descriptive keys (fallback behavior)",
    "Cache is updated automatically by snapshots",
    "Handle \"N/A\" returns gracefully"
  ]
}
