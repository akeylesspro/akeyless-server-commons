<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>src/helpers/phone_number_helpers.ts</title>
    <link rel="stylesheet" href="../styles.css" />
  </head>
  <body>
    <div class="content">
    <h1>src/helpers/phone_number_helpers.ts</h1>
    
    <h2>Purpose</h2>
    <p>Phone number normalization, validation, format detection, and SIM provider inference. Provides utilities for working with Israeli phone numbers, international formats, ICCID numbers, and determining SIM card providers based on phone number prefixes.</p>

    <h2>Dependencies</h2>
    <ul>
      <li><a href="../types/enums/global.html"><code>SimProvider</code></a> enum from <code>src/types/enums</code> - Provider enumeration</li>
      <li><code>TObject</code> from <code>akeyless-types-commons</code> - Generic object type</li>
    </ul>

    <h2>Format Detection Functions</h2>
    <ul>
      <li><code>is_long_phone_number(phone_number)</code> - Checks if phone number is in international format (starts with <code>+</code>)</li>
      <li><code>is_israel_long_phone_number(phone_number)</code> - Checks if phone number is Israeli international format (<code>+9725</code> or <code>+972 5</code>)</li>
      <li><code>is_thailand_long_phone_number(phone_number)</code> - Checks if phone number is Thai international format (<code>+66</code>)</li>
      <li><code>is_international_phone_number(phone_number)</code> - Checks if phone number is international format but not Israeli</li>
      <li><code>is_iccid(number)</code> - Validates if a string is a valid ICCID (19-22 digits starting with <code>89</code>)</li>
    </ul>

    <h2>Conversion Functions</h2>
    <ul>
      <li><code>convert_to_short_israel_phone(international_number)</code> - Converts Israeli international phone number to local format (<code>+972</code> â†’ <code>0</code>)</li>
    </ul>

    <h2>SIM Provider Detection</h2>
    <ul>
      <li><code>is_sim_provider_partner(phone_number)</code> - Checks if phone number belongs to Partner (starts with <code>054</code>)</li>
      <li><code>is_sim_provider_pelephone(phone_number)</code> - Checks if phone number belongs to Pelephone (starts with <code>050</code>)</li>
      <li><code>is_sim_provider_celcom(phone_number)</code> - Checks if phone number belongs to Celcom (starts with <code>052</code>)</li>
      <li><code>is_sim_provider_monogoto(phone_number)</code> - Checks if identifier is a Monogoto ICCID number</li>
      <li><code>get_sim_provider(phone_number)</code> - Determines SIM provider based on phone number prefix or ICCID, returns <code>SimProvider</code> enum value</li>
    </ul>

    <h2>Phone Number Normalization</h2>
    
    <h3><code>long_short_phone_numbers(phone_number: string): {short_phone_number: string, long_phone_number: string, is_israeli: boolean}</code></h3>
    <p>Normalizes phone number to both short and long formats.</p>
    <p><strong>Returns:</strong> Object with:</p>
    <ul>
      <li><code>short_phone_number</code> - Local format number</li>
      <li><code>long_phone_number</code> - International format number</li>
      <li><code>is_israeli</code> - Whether number is Israeli</li>
    </ul>
    <p><strong>Behavior:</strong></p>
    <ul>
      <li>Israeli Local Format (<code>05XXXXXXXXX</code>): Converts to <code>+9725XXXXXXXXX</code></li>
      <li>Israeli International Format (<code>+9725XXXXXXXXX</code>): Converts to <code>05XXXXXXXXX</code></li>
      <li>US Format (<code>+1XXXXXXXXXX</code>): Removes <code>+1</code> prefix</li>
      <li>ICCID Numbers: Returns as-is (no conversion)</li>
    </ul>

    <h2>Context</h2>
    <p>These helpers are used throughout the application for:</p>
    <ul>
      <li><strong>SMS Provider Routing</strong> - Determining which SMS provider to use based on number format</li>
      <li><strong>Phone Number Normalization</strong> - Converting between formats for storage and display</li>
      <li><strong>User Lookup</strong> - Finding users by phone number in various formats</li>
      <li><strong>SIM Provider Detection</strong> - Identifying carrier for device management</li>
      <li><strong>Data Validation</strong> - Validating phone number formats before processing</li>
    </ul>
    </div>
  </body>
</html>
